"use strict";var Gender,__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var r,t=1,n=arguments.length;t<n;t++)for(var o in r=arguments[t])Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o]);return e}).apply(this,arguments)};function getBrowserLanguage(){return navigator.languages&&navigator.languages[0]||navigator.language||navigator.userLanguage}function toMap(e,r){if(e&&r){for(var t=0,n=r;t<n.length;t++){var o=n[t];e.set(o.path,o)}for(var s=0,u=r;s<u.length;s++)(o=u[s]).children&&Array.isArray(o.children)&&toMap(e,o.children)}}function sortPrivileges(e){e.sort(sortBySequence);for(var r=0,t=e;r<t.length;r++){var n=t[r];n.children&&Array.isArray(n.children)&&(n.children=sortPrivileges(n.children))}return e}function sortBySequence(e,r){return e.sequence||(e.sequence=999),r.sequence||(r.sequence=999),e.sequence-r.sequence}Object.defineProperty(exports,"__esModule",{value:!0}),exports.enLocale={id:"en-US",countryCode:"US",dateFormat:"M/d/yyyy",firstDayOfWeek:1,decimalSeparator:".",groupSeparator:",",decimalDigits:2,currencyCode:"USD",currencySymbol:"$",currencyPattern:0},function(e){e.Male="M",e.Female="F",e.Unknown="U"}(Gender=exports.Gender||(exports.Gender={})),exports.getBrowserLanguage=getBrowserLanguage,exports.toMap=toMap,exports.sortPrivileges=sortPrivileges,exports.sortBySequence=sortBySequence;var DefaultResourceService=function(){function e(){this.resource=this.resource.bind(this),this.value=this.value.bind(this),this.format=this.format.bind(this)}return e.prototype.resource=function(){return storage.getResource()},e.prototype.value=function(e,r){var t=this.resource();if(void 0===t)return"";e=t[e];if(!e||0===e.length)return e;if(!r)return e;if("string"==typeof r){t=(t=t[r])||r;return this.format(e,t)}},e.prototype.format=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];if(!(s=e[0])||""===s)return"";if(1<e.length&&Array.isArray(e[1]))for(var t=e[1],n=0;n<t.length;n++)var o=new RegExp("\\{"+n+"\\}","gi"),s=s.replace(o,t[n]);else for(n=1;n<e.length;n++){o=new RegExp("\\{"+(n-1)+"\\}","gi");s=s.replace(o,e[n])}return s},e}();exports.DefaultResourceService=DefaultResourceService;var storage=function(){function u(){}return u.getRedirectUrl=function(){return encodeURIComponent(u.redirectUrl)},u.setPrivileges=function(e){var r=e;if(u._privileges.clear(),e&&(r=sortPrivileges(e),toMap(u._privileges,r)),u._forms=r,!0===u._sessionStorageAllowed)try{null!=e?sessionStorage.setItem("forms",JSON.stringify(e)):sessionStorage.removeItem("forms")}catch(e){u._sessionStorageAllowed=!1}},u.getPrivileges=function(){return u._privileges},u.privileges=function(){var e=u._forms;if(!e&&!0===u._sessionStorageAllowed)try{var r=sessionStorage.getItem("forms");r&&(e=u._forms=JSON.parse(r))}catch(e){u._sessionStorageAllowed=!1}return e||[]},u.setUser=function(e){if((u._user=e)&&e.privileges&&Array.isArray(e.privileges)&&(e.privileges=sortPrivileges(e.privileges)),u._sessionStorageAllowed)try{null!=e?sessionStorage.setItem("authService",JSON.stringify(e)):sessionStorage.removeItem("authService")}catch(e){u._sessionStorageAllowed=!1}},u.user=function(e){var r=u._user;if(!r&&u._sessionStorageAllowed)try{var t=sessionStorage.getItem("authService");t&&(r=u._user=JSON.parse(t))}catch(e){u._sessionStorageAllowed=!1}return r},u.getUserId=function(e){e=u.user(e);return e?e.userId:""},u.username=function(e){e=u.user(e);return e?e.username:""},u.token=function(e){e=u.user(e);return e?e.token:null},u.getUserType=function(e){e=u.user(e);return e?e.userType:null},u.getDateFormat=function(e){e=u.user(e);if(e){if(e.dateFormat){var r=e.dateFormat;return u.moment?r.toUpperCase():r}r=e.language}r&&0!==r.length||(r=getBrowserLanguage()),u.locale&&(t=u.locale(r));var t=t.dateFormat;return u.moment?t.toUpperCase():t},u.language=function(e){e=u.user(e);return e&&e.language?e.language:getBrowserLanguage()},u.getLocale=function(e){if(u.locale){e=u.language(e),e=u.locale(e);if(e)return e}return exports.enLocale},u.loading=function(){return u._loadingService},u.setLoadingService=function(e){u._loadingService=e},u.ui=function(){return u._uiService},u.setUIService=function(e){u._uiService=e},u.getResources=function(){return u._resources},u.setResources=function(e){u._resources=e},u.setResourceService=function(e){u._resourceService=e},u.resource=function(){return u._resourceService},u.getResource=function(){var e=u._resources,r=e[u.language()];return r||e.en},u.getResourceByLocale=function(e){return u._resources[e]},u.setResource=function(e,t,n){var o=Object.assign({},t),r=Object.keys(u._resources).reduce(function(e,r){return e[r]=__assign(__assign(__assign({},u._resources[r]),o[r]),n[r]),e},{}),s=Object.keys(n).reduce(function(e,r){return e[r]?(e[r]=__assign(__assign({},t[r]),n[r]),e):__assign(__assign({},e),((e={})[r]=n[r],e))},o),r=__assign(__assign({},s),r);u._resources[e]=r[e]},u.setInitModel=function(e){u._initModel=e},u.getInitModel=function(){return u._initModel},u.setConfig=function(e){u._c=e},u.config=function(){return u._c},u.redirectUrl=location.origin+"/index.html?redirect=oauth2",u.authentication="authentication",u.home="home",u.autoSearch=!0,u._privileges=new Map,u._resourceService=new DefaultResourceService,u._sessionStorageAllowed=!0,u}();function setSearchPermission(e,r,t,n){t&&(r=t.buildPermission(e,r),n.viewable=r.viewable,n.addable=r.addable,n.editable=r.editable,n.approvable=r.approvable,n.deletable=r.deletable)}function setEditPermission(e,r,t,n){t&&(r=t.buildPermission(e,r),n.addable=r.addable,n.editable=r.editable,n.deletable=r.deletable)}function authenticated(){return!!storage.user()}exports.storage=storage,exports.setSearchPermission=setSearchPermission,exports.setEditPermission=setEditPermission,exports.authenticated=authenticated;var HttpOptionsService=function(){function e(){}return e.prototype.getHttpOptions=function(){var e=storage.token();return e?{headers:{"Content-Type":"application/json;charset=UTF-8",Authorization:"Bearer "+e}}:{headers:{"Content-Type":"application/json;charset=UTF-8"}}},e}();function initForm(e,r){var t;return e&&(e.getAttribute("date-format")||(t=storage.getDateFormat(),e.setAttribute("date-format",t)),setTimeout(function(){r&&r(e),focusFirstElement(e)},100)),e}function focusFirstElement(e){for(var r=0,t=e.length,r=0;r<t;r++){var n=e[r];if(!n.readOnly&&!n.disabled){var o=n.nodeName,s=n.getAttribute("type");if(s&&("BUTTON"!==(s=s.toUpperCase())&&"SUBMIT"!==s||n.focus(),"INPUT"===o&&(o=s)),"BUTTON"!==o&&"RESET"!==o&&"SUBMIT"!==o&&"CHECKBOX"!==o&&"RADIO"!==o){n.focus();try{n.setSelectionRange(0,n.value.length)}catch(e){}return}}}}function language(e){return storage.language(e)}function getDateFormat(e){return storage.getDateFormat(e)}function getPrivileges(){return storage.getPrivileges()}function privileges(){return storage.privileges()}function user(e){return storage.user(e)}function getUserId(e){return storage.getUserId(e)}function username(e){return storage.username(e)}function getUserType(e){return storage.getUserType(e)}function token(e){return storage.token(e)}function currency(e){return storage.currency(e)}function locale(e){return storage.locale(e)}function getLocale(e){return storage.getLocale(e)}function getInitModel(){return storage.getInitModel()}function config(){return storage.config()}function message(e,r){storage.message(e,r)}function alert(e,r,t,n){storage.alert(e,r,t,n)}function confirm(e,r,t,n,o,s){storage.confirm(e,r,t,n,o,s)}function resource(){return storage.resource()}function loading(){return storage.loading()}function ui(){return storage.ui()}function removeError(e){var r=storage.ui();r&&r.removeError(e)}function getValue(e,r,t){var n=storage.ui();return n?n.getValue(e,r,t):e.value}function registerEvents(e){var r=storage.ui();r&&e&&r.registerEvents(e)}function numberOnFocus(e,r){e.preventDefault(),r=r||storage.getLocale(),storage.ui().numberOnFocus(e,r)}function numberOnBlur(e,r){e.preventDefault(),r=r||storage.getLocale(),storage.ui().numberOnBlur(e,r)}function percentageOnFocus(e,r){e.preventDefault(),r=r||storage.getLocale(),storage.ui().percentageOnFocus(e,r)}function currencyOnFocus(e,r,t){var n;e.preventDefault(),r=r||storage.getLocale(),t||(t=(t=(n=e.currentTarget).getAttribute("currency-code"))||n.form.getAttribute("currency-code")),storage.ui().currencyOnFocus(e,r,t)}function currencyOnBlur(e,r,t,n){var o;e.preventDefault(),r=r||storage.getLocale(),t||(t=(t=(o=e.currentTarget).getAttribute("currency-code"))||o.form.getAttribute("currency-code")),storage.ui().currencyOnBlur(e,r,t,n)}function emailOnBlur(e){e.preventDefault(),storage.ui().emailOnBlur(e)}function urlOnBlur(e){e.preventDefault(),storage.ui().urlOnBlur(e)}function phoneOnBlur(e){e.preventDefault(),storage.ui().phoneOnBlur(e)}function faxOnBlur(e){e.preventDefault(),storage.ui().phoneOnBlur(e)}function requiredOnBlur(e){e.preventDefault(),storage.ui().requiredOnBlur(e)}function checkPatternOnBlur(e){e.preventDefault(),storage.ui().patternOnBlur(e)}function messageByHttpStatus(e,r){var t=r.value("error_internal");return 401===e?t=r.value("error_unauthorized"):403===e?t=r.value("error_forbidden"):404===e?t=r.value("error_not_found"):410===e?t=r.value("error_gone"):503===e&&(t=r.value("error_service_unavailable")),t}function error(e,r,t){var n,o=r.value("error"),s=r.value("error_internal");(e=e&&(e&&e.response?e.response:e))&&(n=e.status)&&!isNaN(n)&&(s=messageByHttpStatus(n,r)),t(s,o)}function handleError(e){return error(e,storage.resource(),storage.alert)}function inputView(){return{resource:storage.resource(),showError:storage.alert,getLocale:storage.getLocale,loading:storage.loading()}}function inputSearch(){return{resource:storage.resource(),showMessage:storage.message,showError:storage.alert,ui:storage.ui(),getLocale:storage.getLocale,loading:storage.loading()}}function inputEdit(){return{resource:storage.resource(),showMessage:storage.message,showError:storage.alert,confirm:storage.confirm,ui:storage.ui(),getLocale:storage.getLocale,loading:storage.loading()}}function inputDiff(){return{resource:storage.resource(),showMessage:storage.message,showError:storage.alert,loading:storage.loading()}}exports.httpOptionsService=new HttpOptionsService,exports.initForm=initForm,exports.focusFirstElement=focusFirstElement,exports.language=language,exports.getDateFormat=getDateFormat,exports.getPrivileges=getPrivileges,exports.privileges=privileges,exports.user=user,exports.getUserId=getUserId,exports.username=username,exports.getUserType=getUserType,exports.token=token,exports.currency=currency,exports.locale=locale,exports.getLocale=getLocale,exports.getInitModel=getInitModel,exports.config=config,exports.message=message,exports.alert=alert,exports.confirm=confirm,exports.resource=resource,exports.loading=loading,exports.ui=ui,exports.removeError=removeError,exports.getValue=getValue,exports.registerEvents=registerEvents,exports.numberOnFocus=numberOnFocus,exports.numberOnBlur=numberOnBlur,exports.percentageOnFocus=percentageOnFocus,exports.currencyOnFocus=currencyOnFocus,exports.currencyOnBlur=currencyOnBlur,exports.emailOnBlur=emailOnBlur,exports.urlOnBlur=urlOnBlur,exports.phoneOnBlur=phoneOnBlur,exports.faxOnBlur=faxOnBlur,exports.requiredOnBlur=requiredOnBlur,exports.checkPatternOnBlur=checkPatternOnBlur,exports.messageByHttpStatus=messageByHttpStatus,exports.error=error,exports.handleError=handleError,exports.inputView=inputView,exports.inputSearch=inputSearch,exports.inputEdit=inputEdit,exports.inputDiff=inputDiff;